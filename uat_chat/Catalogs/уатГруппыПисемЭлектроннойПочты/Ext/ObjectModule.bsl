////////////////////////////////////////////////////////////////////////////////
// ПЕРЕМЕННЫЕ ОБЪЕКТА

Перем Права 				Экспорт; // Переменная объекта - ссылка на коллекцию прав, настроек и переменных окружения
Перем КонтролироватьПорядок Экспорт; // Контролировать порядок объекта при записи
									//(объект с неуникальным порядком выдаст ошибку)


////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ - ОБРАБОТЧИКИ СТАНДАРТНЫХ СОБЫТИЙ ОБЪЕКТА

Процедура ПередЗаписью(Отказ)
	Если ОбменДанными.Загрузка Тогда
		Возврат;
	КонецЕсли;
	
	уатОбщегоНазначения.уатПроверкаПравПередЗаписьюВСправочниках(ЭтотОбъект, Отказ, , Права);	
	
	Если НЕ Отказ И ПометкаУдаления И НЕ Владелец.ПометкаУдаления Тогда
		Если Владелец.ГруппаВходящие = Ссылка Тогда
			Сообщить("Группа является группой входящих писем по умолчанию для учетной записи " + СокрЛП(Владелец) + ". Установка пометки на удаление - запрещена.");
			Отказ = Истина;
		ИначеЕсли Владелец.ГруппаИсходящие = Ссылка Тогда
			Сообщить("Группа является группой исходящих писем по умолчанию для учетной записи " + СокрЛП(Владелец) + ". Установка пометки на удаление - запрещена.");
			Отказ = Истина;
		ИначеЕсли Владелец.ГруппаУдаленные = Ссылка Тогда
			Сообщить("Группа является группой удаленных писем по умолчанию для учетной записи " + СокрЛП(Владелец) + ". Установка пометки на удаление - запрещена.");
			Отказ = Истина;
		ИначеЕсли Владелец.ГруппаЧерновики = Ссылка Тогда
			Сообщить("Группа является группой черновых писем по умолчанию для учетной записи " + СокрЛП(Владелец) + ". Установка пометки на удаление - запрещена.");
			Отказ = Истина;
		КонецЕсли;
	КонецЕсли; 
	
	Если НЕ Отказ Тогда
		уатОтношенияСКлиентами.уатПередЗаписьюОбъектаПорядка(Отказ, ЭтотОбъект, КонтролироватьПорядок);
	КонецЕсли; 
	
КонецПроцедуры


////////////////////////////////////////////////////////////////////////////////
// ИСПОЛНЯЕМАЯ ЧАСТЬ МОДУЛЯ

// сохранение ссылки на коллекцию прав, настроек и окружения
Права = Неопределено;
#Если Клиент Тогда
	Права = глПраваУАТ;
#КонецЕсли

КонтролироватьПорядок = Истина;
